"""
## Name of Prob
947. Most Stones Removed with Same Row or Column

## Link
https://leetcode.com/problems/most-stones-removed-with-same-row-or-column/

## Note
Move consists of removing a stone that shares a column or row with another stone on the grid.
Each coordinate point may have at most one stone

1 <= stones.length <= 1000
0 <= stones[i][j] < 10000


## Input
position of stones

## Output
maximum number of moves


## Strategy

Compose two sorted list
group by row, group by col
each list will be sort by size
"""
from collections import defaultdict
from typing import List


class Solution:
    def removeStones(self, stones: List[List[int]]) -> int:
        i_count = defaultdict(int)
        j_count = defaultdict(int)
        for stone_i, stone_j in stones:
            i_count[stone_i] += 1
            j_count[stone_j] += 1

        len_stones = len(stones)
        for i in range(len_stones):
            move_actioned = False

            min_count_val = len_stones
            max_count_val = 0
            min_stone = None
            for stone_i, stone_j in stones:
                if j_count[stone_j] >= 2:
                    if i_count[stone_i] < min_count_val or (
                            i_count[stone_i] == min_count_val and max_count_val < j_count[stone_j]):
                        min_count_val = i_count[stone_i]
                        min_stone = [stone_i, stone_j]
                if i_count[stone_i] >= 2:
                    if j_count[stone_j] < min_count_val or (
                            j_count[stone_j] == min_count_val and max_count_val < i_count[stone_i]):
                        min_count_val = j_count[stone_j]
                        min_stone = [stone_i, stone_j]

            if min_stone is not None:
                move_actioned = True

                i_count[min_stone[0]] -= 1
                j_count[min_stone[1]] -= 1
                stones.remove(min_stone)

            if not move_actioned:
                return i
        return len_stones


s = Solution()
assert s.removeStones([[0, 0], [0, 1], [1, 0], [1, 2], [2, 1], [2, 2]]) == 5
assert s.removeStones([[0, 0], [0, 2], [1, 1], [2, 0], [2, 2]]) == 3
assert s.removeStones([[0, 0]]) == 0
assert s.removeStones(
    [[42, 6], [45, 45], [16, 29], [80, 40], [43, 3], [39, 83], [18, 19], [77, 80], [65, 39], [21, 6], [80, 78], [1, 11],
     [80, 12], [26, 70], [98, 9], [54, 13], [53, 40], [85, 3], [75, 32], [20, 9], [37, 85], [48, 14], [31, 65], [9, 57],
     [58, 47], [29, 92], [58, 20], [38, 38], [71, 12], [27, 50], [17, 62], [89, 89], [51, 32], [10, 85], [19, 45],
     [66, 88], [31, 21], [5, 34], [33, 34], [70, 7], [93, 93], [19, 23], [49, 10], [12, 39], [92, 35], [82, 71],
     [69, 47], [60, 65], [70, 82], [59, 36], [76, 87], [3, 71], [98, 36], [26, 24], [97, 86], [51, 16], [92, 10],
     [39, 88], [82, 77], [30, 51], [28, 68], [75, 88], [97, 13], [91, 22], [30, 70], [11, 10], [77, 23], [33, 54],
     [43, 78], [2, 85], [66, 18], [41, 22], [72, 74], [98, 65], [8, 51], [47, 72], [96, 60], [71, 8], [10, 66],
     [40, 67], [12, 52], [9, 91], [35, 86], [39, 3], [90, 64], [83, 58], [24, 90], [54, 16], [22, 83], [58, 43],
     [53, 49], [59, 34], [22, 0], [89, 30], [28, 94], [3, 22], [53, 61], [56, 46], [72, 51], [7, 74], [67, 93],
     [56, 33], [55, 59], [20, 15], [20, 68], [75, 70], [78, 28], [97, 76], [4, 8], [55, 33], [62, 61], [19, 37],
     [21, 89], [68, 53], [96, 66], [18, 1], [42, 15], [4, 60], [4, 90], [81, 61], [2, 75], [0, 50], [41, 60], [14, 38],
     [45, 17], [29, 3], [59, 2], [40, 5], [40, 90], [28, 56], [75, 39], [99, 34], [16, 73], [43, 67], [14, 97],
     [28, 90], [70, 22], [67, 66], [85, 76], [82, 1], [63, 33], [4, 29], [75, 47], [11, 69], [45, 46], [59, 79],
     [24, 91], [55, 55], [91, 10], [73, 94], [36, 86], [94, 5], [1, 7], [27, 18], [76, 3], [54, 20], [83, 36], [69, 39],
     [25, 80], [47, 42], [71, 36], [21, 16], [88, 97], [92, 76], [99, 79], [15, 54], [70, 71], [84, 24], [64, 19],
     [72, 44], [19, 36], [68, 59], [47, 60], [19, 98], [77, 93], [82, 18], [31, 1], [24, 85], [80, 49], [15, 56],
     [84, 34], [24, 48], [3, 75], [87, 98], [16, 59], [48, 96], [45, 29], [50, 31], [50, 35], [37, 66], [47, 44],
     [79, 27], [65, 55], [86, 76], [10, 45], [43, 9], [33, 46], [15, 6], [37, 61], [3, 29], [77, 62], [12, 54]]) == 196
assert s.removeStones(
    [[46, 42], [90, 187], [0, 175], [46, 135], [162, 97], [42, 20], [25, 195], [109, 117], [109, 236], [187, 65],
     [178, 194], [5, 12], [220, 15], [124, 270], [256, 40], [138, 163], [140, 131], [132, 224], [265, 250], [204, 244],
     [249, 145], [167, 44], [269, 68], [26, 54], [59, 51], [172, 87], [119, 31], [279, 284], [6, 287], [39, 179],
     [247, 224], [277, 299], [78, 67], [226, 88], [94, 57], [103, 73], [115, 232], [248, 0], [64, 117], [94, 67],
     [79, 224], [15, 43], [105, 176], [15, 178], [18, 242], [154, 243], [238, 125], [89, 259], [142, 287], [53, 277],
     [98, 82], [29, 62], [258, 232], [264, 157], [14, 96], [284, 283], [189, 99], [189, 214], [272, 77], [282, 140],
     [214, 85], [27, 279], [232, 98], [161, 58], [186, 157], [120, 16], [96, 172], [111, 6], [275, 185], [226, 194],
     [0, 297], [96, 130], [97, 244], [286, 186], [14, 95], [258, 201], [208, 190], [63, 137], [48, 177], [87, 238],
     [105, 126], [249, 239], [236, 42], [85, 158], [47, 251], [201, 270], [84, 31], [58, 22], [149, 189], [186, 156],
     [49, 194], [251, 266], [5, 159], [109, 162], [41, 152], [28, 23], [94, 87], [132, 251], [191, 209], [251, 37],
     [170, 215], [130, 229], [235, 77], [211, 107], [38, 197], [257, 169], [113, 179], [9, 270], [84, 56], [263, 292],
     [198, 90], [286, 248], [265, 108], [171, 4], [76, 90], [241, 248], [215, 224], [278, 257], [113, 219], [140, 54],
     [247, 57], [66, 262], [255, 208], [7, 16], [34, 281], [230, 278], [1, 192], [292, 52], [9, 281], [169, 140],
     [187, 253], [219, 97], [220, 145], [239, 98], [236, 288], [238, 68], [228, 270], [34, 1], [159, 255], [199, 127],
     [159, 153], [186, 144], [243, 276], [239, 175], [12, 131], [238, 267], [196, 41], [10, 112], [184, 111], [14, 262],
     [284, 181], [77, 145], [149, 260], [153, 119], [155, 229], [200, 187], [193, 126], [150, 212], [230, 265],
     [83, 263], [137, 232], [240, 40], [202, 18], [6, 276], [51, 249], [208, 245], [156, 58], [41, 51], [22, 127],
     [111, 26], [250, 91], [44, 205], [272, 222], [182, 48], [257, 259], [265, 284], [97, 10], [60, 22], [18, 235],
     [223, 191], [177, 92], [161, 282], [207, 99], [209, 256], [120, 240], [276, 128], [3, 169], [102, 109], [240, 275],
     [50, 288], [65, 216], [230, 8], [6, 289], [89, 89], [140, 280], [283, 9], [122, 19], [236, 246], [165, 190],
     [174, 284], [99, 182], [270, 108], [205, 78], [227, 161], [16, 283], [99, 156], [101, 228], [143, 179], [286, 50],
     [19, 72], [45, 226], [27, 88], [27, 37], [175, 192], [17, 34], [49, 249], [182, 166], [120, 32], [182, 63],
     [270, 42], [113, 199], [52, 29], [255, 77], [60, 109], [188, 26], [88, 21], [172, 53], [135, 67], [70, 82],
     [16, 296], [84, 65], [195, 125], [93, 75], [199, 232], [106, 124], [284, 280], [190, 76], [209, 73], [214, 86],
     [34, 31], [17, 61], [120, 176], [252, 233], [68, 48], [174, 161], [155, 171], [225, 64], [105, 77], [204, 239],
     [195, 54], [299, 215], [108, 167], [242, 283], [204, 197], [12, 241], [204, 42], [31, 189], [149, 214], [33, 17],
     [225, 260], [70, 254], [222, 267], [225, 103], [276, 283], [236, 84], [272, 166], [137, 53], [133, 167], [99, 8],
     [286, 190], [104, 70], [57, 73], [272, 140], [190, 239], [78, 133], [236, 173], [226, 171], [294, 54], [201, 237],
     [48, 171], [144, 144], [134, 260], [86, 17], [171, 3], [55, 244], [232, 115], [227, 121], [85, 2], [6, 109],
     [45, 62], [146, 136], [220, 211], [149, 276], [252, 68], [298, 11], [75, 140], [260, 174], [126, 29], [190, 150],
     [123, 209], [290, 35], [264, 6], [5, 188], [84, 68], [65, 52], [138, 75], [37, 45], [235, 86], [223, 251],
     [95, 23], [99, 80], [149, 172], [182, 222], [71, 161], [191, 83], [220, 279], [171, 137], [112, 215], [118, 68],
     [110, 97], [84, 220], [4, 3], [296, 187], [73, 204], [266, 37], [255, 264], [211, 211], [244, 244], [41, 137],
     [171, 91], [97, 253], [40, 79], [22, 276], [247, 254], [128, 90], [184, 39], [42, 77], [170, 6], [172, 294],
     [141, 164], [224, 299], [185, 129], [55, 123], [204, 233], [60, 102], [4, 297], [79, 159], [260, 186], [175, 73],
     [286, 196], [83, 101], [103, 136], [128, 162], [295, 34], [150, 63], [155, 140], [150, 36], [140, 81], [196, 118],
     [90, 74], [219, 191], [145, 17], [225, 95], [142, 107], [262, 137], [205, 238], [105, 27], [229, 194], [231, 162],
     [115, 21], [280, 126], [136, 76], [152, 166], [132, 254], [37, 34], [11, 51], [117, 184], [210, 110], [167, 251],
     [174, 18], [67, 180], [298, 239], [22, 201], [70, 280], [180, 207], [213, 39], [80, 95], [20, 170], [182, 108],
     [63, 116], [92, 6], [229, 8], [250, 276], [159, 9], [298, 204], [208, 118], [180, 39], [67, 189], [296, 113],
     [244, 4], [132, 231], [217, 165], [3, 245], [201, 42], [78, 12], [145, 99], [274, 9], [110, 73], [57, 202],
     [211, 92], [254, 277], [111, 222], [248, 122], [162, 106], [10, 222], [107, 144], [221, 252], [215, 182],
     [192, 178], [285, 1], [152, 120], [151, 0], [225, 62], [87, 120], [211, 127], [39, 245], [186, 283], [232, 53],
     [50, 100], [287, 216], [294, 186], [46, 8], [85, 51], [91, 47], [257, 142], [109, 284], [242, 6], [296, 284],
     [209, 54], [11, 141], [192, 226], [240, 240], [51, 294], [191, 41], [191, 208], [266, 172], [91, 262], [160, 105],
     [150, 104], [166, 140], [184, 36], [244, 77], [236, 34], [251, 26], [18, 14], [166, 158], [259, 264], [52, 71],
     [270, 186], [77, 210], [220, 155], [28, 151], [139, 167], [158, 154], [107, 164], [198, 125], [179, 217],
     [285, 13], [119, 176], [73, 146], [183, 262], [219, 221], [170, 223], [165, 9], [282, 224], [79, 2], [124, 138],
     [2, 213], [112, 23], [125, 139], [106, 85], [166, 2], [284, 115], [237, 54], [23, 157], [236, 70], [26, 284],
     [52, 146], [180, 79], [95, 160], [240, 88], [248, 39], [278, 68], [212, 21], [237, 132], [131, 254], [214, 232],
     [42, 5], [299, 43], [95, 114], [101, 107], [233, 232], [196, 214], [67, 61], [25, 126], [225, 96], [67, 164],
     [110, 253], [155, 161], [269, 226], [191, 68], [173, 154], [82, 186], [290, 27], [159, 278], [157, 247],
     [277, 261], [286, 193], [230, 251], [38, 100], [0, 173], [60, 182], [90, 2], [186, 95], [291, 159], [297, 191],
     [284, 218], [154, 141], [176, 125], [292, 138], [298, 293], [1, 43], [15, 258], [253, 127], [255, 154], [287, 113],
     [91, 94], [260, 30], [168, 164], [8, 248], [144, 196], [74, 101], [35, 95], [209, 44], [18, 114], [51, 32],
     [102, 236], [184, 132], [268, 265], [189, 114], [210, 69], [110, 62], [208, 93], [68, 187], [10, 274], [89, 252],
     [113, 79], [68, 202], [46, 106], [63, 146], [137, 175], [166, 193], [98, 139], [198, 21], [73, 235], [95, 67],
     [37, 124], [132, 267], [275, 88], [87, 92], [270, 153], [54, 143], [92, 2], [11, 70], [30, 31], [85, 45], [35, 51],
     [206, 48], [182, 208], [180, 126], [167, 83], [125, 259], [57, 93], [133, 292], [187, 297], [263, 15], [125, 168],
     [195, 287], [89, 24], [217, 83], [273, 24], [7, 10], [88, 277], [43, 147], [218, 242], [18, 133], [156, 299],
     [113, 158], [170, 155], [194, 140], [132, 181], [128, 253], [217, 178], [209, 125], [187, 185], [52, 129],
     [11, 259], [120, 132], [235, 14], [200, 60], [0, 137], [274, 161]]) == 595
